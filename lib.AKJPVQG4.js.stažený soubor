import{a as h}from"./lib.BXUODSEE.js";import{m as g,o as S}from"./lib.PUZNKYJD.js";function U(e){return[e.slice(0,2),e.slice(2,4),e.slice(4,5)]}function C(e){return e.charCodeAt(0)-97+(e.charCodeAt(1)-49)*8}function l(e,n){let i=e&7,r=n&7,o=e>>3,t=n>>3;return Math.max(Math.abs(i-r),Math.abs(o-t))}function k(e){return e===e.toLowerCase()}function b(e){let n=e.split(" "),i={pieces:{},turn:n[1]==="w"};return n[0].split("/").slice(0,8).forEach((r,o)=>{let t=0;r.split("").forEach(u=>{if(u==="~")return;let f=parseInt(u,10);f?t+=f:(i.pieces[(7-o)*8+t]=u,t++)})}),i}function v(e){return[e-1,e-9,e-8,e-7,e+1,e+9,e+8,e+7].filter(function(n){return n>=0&&n<64&&l(e,n)===1})}function A(e){return[e+17,e+15,e+10,e+6,e-6,e-10,e-15,e-17].filter(function(n){return n>=0&&n<64&&l(e,n)<=2})}var O=[8,1,-8,-1],T=[9,-9,7,-7],y=[...O,...T];function d(e,n,i){let r=[];return n.forEach(function(o){for(let t=e+o;t>=0&&t<64&&l(t,t-o)===1&&(r.push(t),!i.pieces[t]);t+=o);}),r}function E(e,n,i=void 0){if(n.includes("@"))return h(n);let r=U(n),o=C(r[0]),t=C(r[1]),u=e.pieces[o],f=e.pieces[t],c=e.pieces[o].toLowerCase();if(c==="p"){let s;return n[0]===n[2]?s=r[1]:s=n[0]+"x"+r[1],r[2]&&(s+="="+r[2].toUpperCase()),s}if(c==="k"&&(f&&k(u)===k(f)||l(o,t)>1))return t<o?"O-O-O":"O-O";let p=c.toUpperCase(),a=[];c==="k"?a=v(t):c==="n"?a=A(t):c==="r"?a=d(t,O,e):c==="b"?a=d(t,T,e):c==="q"&&(a=d(t,y,e));let x=!1,m=!1;for(let s=0;s<a.length;s++)a[s]===o||e.pieces[a[s]]!==u||i&&!i.has(S(a[s])+r[1])||(o>>3===a[s]>>3&&(m=!0),(o&7)===(a[s]&7)?x=!0:m=!0);return m&&(p+=n[0]),x&&(p+=n[1]),f&&(p+="x"),p+=r[1],p}function M(e,n){let i=b(e),r={},o=new Set(n);return n.forEach(function(t){let u=E(i,t,o);r[u]=t,u.includes("x")&&(r[u.replace("x","")]=t)}),r}function $(e,n){if(e in n)return n[e];let i=e.toLowerCase();for(let r in n)if(r.toLowerCase()===i)return n[r]}var L=e=>e.split("").map(n=>{if(n==="x")return i18n.nvui.sanTakes;if(n==="+")return i18n.nvui.sanCheck;if(n==="#")return i18n.nvui.sanCheckmate;if(n==="=")return i18n.nvui.sanPromotesTo;if(n==="@")return i18n.nvui.sanDroppedOn;let i=n.charCodeAt(0);if(i>48&&i<58)return n;if(i>96&&i<105)return n.toUpperCase();let r=g(n);return r?q(r):n}).join(" ").replace("O - O - O",i18n.nvui.sanLongCastling).replace("O - O",i18n.nvui.sanShortCastling),q=e=>i18n.nvui[e]||e;function D(e){return e?L(e).replace(/^A /,'"A"').replace(/(\d) E (\d)/,"$1,E $2").replace(/C /,"c ").replace(/F /,"f ").replace(/(\d) H (\d)/,"$1H$2").replace(/(\d) H (\d)/,"$1H$2"):i18n.nvui.gameStart}export{C as a,l as b,b as c,E as d,M as e,$ as f,D as g};
